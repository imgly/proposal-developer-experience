import{j as e}from"./jsx-runtime.DY7NhS4F.js";import{r as a}from"./index.hm4EbzaD.js";import{g as w,a as S}from"./path.CEkIQWnV.js";import{R as b}from"./ReactIcon.COk6PIZI.js";const C=2;function M(){const[s,d]=a.useState(""),[n,c]=a.useState([]),[o,g]=a.useState(!1),[x,m]=a.useState(null),[y,h]=a.useState(null),l=a.useCallback(()=>{const t=document.getElementById("search-modal");t&&t.close(),d(""),c([]),g(!1),m(null)},[]),k=a.useCallback(t=>{t.target===t.currentTarget&&l()},[l]);a.useEffect(()=>{(async()=>{try{const i=await import(w("/pagefind/pagefind.js").href);await i.init(),h(i)}catch{m("Failed to load search functionality.")}})()},[]);const f=async t=>{t.preventDefault()},p=async t=>{const r=t.target.value;if(d(r),!r.trim()||!y){c([]);return}g(!0),m(null);try{const i=E(window.location.pathname),v=await y.search(r,{filters:i}),j=await Promise.all(v.results.slice(0,10).map(N=>N.data()));c(j)}catch{m("An error occurred while searching")}finally{g(!1)}},u=a.useCallback(t=>{t.key==="Escape"&&l()},[l]);return a.useEffect(()=>(document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}),[u]),e.jsxs("dialog",{id:"search-modal",className:"bg-imglygray-50 dark:bg-dark-imglygray-700 backdrop:bg-dark-imglygray-950 dark:border-imglygray-50/8 border-dark-imglygray-700/8 max-w-screen basis-md md:w-2xl m-0 mx-auto mt-[10vmin] h-fit w-full border p-6 pt-5 shadow-2xl backdrop:opacity-75 md:rounded-2xl",onClick:k,children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("div",{className:"dark:text-dark-imglytext text-xl font-semibold",children:"Search"}),e.jsx("button",{onClick:l,className:"text-imglytext/32 dark:text-dark-imglytext/32 hover:text-imglytext dark:hover:text-dark-imglytext cursor-pointer",type:"button","aria-label":"Close search",children:e.jsx(b,{name:"close",size:"24"})})]}),e.jsx("form",{onSubmit:f,className:"mb-4",children:e.jsxs("div",{className:"text-imglytext dark:text-dark-imglytext border-imglyblue/64 dark:border-dark-imglyblue/64 hover:text-imglyblue dark:hover:text-dark-imglyblue hover:border-imglyblue dark:hover:border-dark-imglyblue hover:bg-imglyblue-800/8 dark:hover:bg-dark-imglyblue-200/8 mb-8 flex items-center overflow-hidden rounded-lg border p-0",children:[e.jsx("input",{autoFocus:!0,type:"text",value:s,onChange:p,placeholder:"Search documentation...",className:"bg-imglygray-300 dark:bg-dark-imglygray-950 focus:bg-imglyblue/8 dark:focus:bg-dark-imglyblue/4 dark:text-dark-imglytext w-full self-stretch px-4 py-2 outline-none"}),e.jsx("button",{type:"submit",className:"bg-imglyblue-800 hover:bg-imglyblue-700 active:bg-imglyblue-900 dark:hover:bg-dark-imglyblue-100 dark:active:bg-dark-imglyblue-200/64 dark:bg-dark-imglyblue-200 dark:text-imglyblue cursor-pointer p-3 text-white transition-colors duration-200 disabled:cursor-not-allowed disabled:opacity-50",disabled:o,"aria-label":"Submit search",children:e.jsx(b,{name:"search",size:"20"})})]})}),x&&e.jsx("div",{className:"bg-imglyred-200 dark:bg-imglyred-950 border-imglyred-600 dark:border-dark-imglyred-600 dark:text-imglyred-500 text-imglyred-800 mb-4 rounded-lg border px-4 py-3",children:x}),o&&e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("div",{className:"border-imglyblue mx-auto h-8 w-8 animate-spin rounded-full border-4 border-t-transparent"}),e.jsx("p",{className:"text-imglygray-500 dark:text-dark-imglygray-400 mt-2",children:"Searching..."})]}),!o&&n.length>0&&e.jsxs("div",{className:"mt-4 space-y-4 overflow-y-auto lg:max-h-[60vh]",children:[e.jsxs("div",{className:"text-imglytext/64 dark:text-dark-imglytext/64 text-sm font-medium",children:[n.length," results found"]}),n.map(t=>e.jsxs("div",{className:"border-imglygray-200 dark:border-dark-imglygray-700 rounded-lg border p-4",children:[e.jsx("a",{href:t.url,className:"text-imglyblue dark:text-dark-imglyblue text-lg font-medium hover:underline",onClick:l,children:t.meta?.title||"Untitled"}),e.jsx("div",{className:"text-imglytext/64 dark:text-dark-imglytext/80 mt-1 text-sm",dangerouslySetInnerHTML:{__html:t.excerpt||""}}),t.sub_results&&t.sub_results.length>0&&e.jsx("div",{className:"border-imglygray-200 dark:border-dark-imglygray-700 mt-2 border-l-2 pl-4",children:t.sub_results.slice(0,C).map(r=>e.jsxs("div",{className:"mt-2",children:[e.jsx("a",{href:r.url,className:"text-imglyblue dark:text-dark-imglyblue text-sm font-medium hover:underline",onClick:l,children:r.title||"Untitled"}),e.jsx("div",{className:"text-imglytext/64 dark:text-dark-imglytext/64 mt-1 text-xs",dangerouslySetInnerHTML:{__html:r.excerpt||""}})]},r.url))})]},t.url))]}),!o&&s&&n.length===0&&e.jsx("div",{className:"py-8 text-center",children:e.jsxs("p",{className:"text-imglytext/64 dark:text-dark-imglytext/64 font-medium",children:["No results found for “",s,"”"]})})]})}function E(s){const d=S(s);return d?{platform:d.id}:{}}export{M as SearchModalReact};
